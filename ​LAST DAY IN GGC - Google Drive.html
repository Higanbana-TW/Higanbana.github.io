<!DOCTYPE html>
<html lang="zh-Hant">

<!-- 網站title與文字底色 -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Album: Daily photo / 彼岸花；開彼岸。</title>
    <style>
        @import url('https://fonts.googleapis.com/earlyaccess/cwtexming.css');
        header {
            background-color: #222;
            color: rgba(199, 118, 131, 0.986);
            padding: 10px 0;
            text-align: center;
        }
        nav {
            background-color: #444;
            color: #fff;
            text-align: center;
        }
        nav ul {
            list-style-type: none;
            margin: 1px;
            padding: 0px;
        }
        nav ul > li {
            display: inline-block;
            position: relative;
        }
        nav ul > li > a {
            display: block;
            text-decoration: none;
            color: #fff;
            padding: 5px;
            margin: 0 5px;
        }
        nav a:hover {
            background-color: #666;
            color: rgb(248, 161, 161);
        }
        .active {
            color: rgb(250, 136, 136);
        }
        div {
            position: relative;
        }
        @keyframes fadein {
            0% {opacity: 0;}
            100% {opacity: 1;}
            from {left: -100px;}
            to   {left: 0px;}
        }
        .ant {
            animation: fadein 1s ease;
        }
        @keyframes fadein_top {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }

            from {
                top: -50px;
            }

            to {
                top: 0px;
            }
        }

        .ant_top {
            animation: fadein_top 2s ease;
        }

        @keyframes fadein_bot {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }

            from {
                bottom: -50px;
            }

            to {
                bottom: 0px;
            }
        }

        .ant_bot {
            animation: fadein_bot 2s ease;
        }

        center {
            font-family: 'cwTeXMing', 'Arial', serif;
        }
        /* 子選單樣式 */
        .submenu {
            display: none;
            position: absolute;
            background-color: #444;
            box-shadow: 0px 2px 5px #666;
            z-index: 1;
        }
        nav ul > li:hover .submenu {
            display: block;
        }
        .submenu > li > a {
            display: block;
            padding: 5px 5px;
            text-decoration: none;
            color: #fff;
        }
        .submenu > li > a:hover {
            background-color: #666;
            color: rgb(248, 161, 161);
        }
        /* 方塊樣式 */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            grid-gap: 10px;
        }
        .gallery img {
            width: 100%;
            height: auto;
            max-width: 200px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .gallery img:hover {
            transform: scale(1.1);
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            padding-top: 100px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.9);
        }
        .modal-content {
            margin: auto;
            display: block;
            height: 70%;
            max-height: 700px;
            position: relative;
        }
        .close {
            color: #fff;
            position: absolute;
            top: 10px;
            right: 25px;
            font-size: 30px;
            font-weight: bold;
            transition: 0.3s;
        }
        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
        .prev,
        .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            margin-top: -50px;
            color: #fff;
            font-weight: bold;
            font-size: 20px;
            transition: 0.6s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
        }
        .prev {
            left: 0;
        }
        .next {
            right: 0;
            border-radius: 3px 0 0 3px;
        }
        .prev:hover,
        .next:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }
        .thumbnail {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            flex-wrap: nowrap;
            margin-top: 20px;
            overflow-x: auto;
            overflow-y: hidden;
            height: 220px;
            padding: 10px 0;
            scrollbar-width: auto;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }
        .thumbnail::-webkit-scrollbar {
            height: 8px;
        }
        .thumbnail::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        .thumbnail::-webkit-scrollbar-thumb {
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }
        .thumbnail::-webkit-scrollbar-thumb:hover {
            background-color: rgba(255, 255, 255, 0.5);
        }
        .thumbnail img {
            height: 200px;
            width: auto;
            object-fit: contain;
            margin-right: 10px;
            cursor: pointer;
            transition: transform 0.3s ease, opacity 0.3s ease;
            flex-shrink: 0;
            border: 2px solid transparent;
            border-radius: 4px;
        }
        .thumbnail img:hover {
            transform: scale(1.05);
            opacity: 0.9;
        }
        .thumbnail img.active {
            border: 3px solid #fff;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        .thumbnail img:last-child {
            margin-right: 0;
        }
        .caption {
            color: #fff;
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
        }

</style>
    
    <script>
        $(document).ready(function(){
            $('.tr_1_more').on("click",function(){
                $('.tr_1_more').hide() ;
                $('.tr_1').hide() ;
                $('.tr_2').show() ;
            })
            $('.tr_1_more').show() ;
            $('.tr_1').show() ;
            $('.tr_2').hide() ;
        })
    </script>
</head>

<body>
    <!-- 網站title -->
    <center>
        <table border="0" class="styleNews" style="border-spacing: 0px 0px; padding: 0px 0px" width="1080">
            <tr>
                <td class="styleNewsContentRight" align="center">
                    <header>
                        <h1>彼岸花；開彼岸。</h1>
                    </header>
                </td>
            </tr>
        </table>
    </center>
    <center>
        <!-- 網址目錄 -->
        <table border="0" class="styleNews" style="border-spacing: 0px 0px; padding: 0px 0px" width="1080">
            <tr>
                <td class="styleNewsContentRight" align="center">
                    <nav>
                        <ul>
                            <li>
                                <a href="./Home.html">Home</a>
                            </li>
                            <li>
                                <a href="./Aboutus.html">About us</a>
                                <ul class="submenu">
                                    <li><a href="./Intro.html">Intro</a></li>
                                    <li><a href="./Managers.html">Managers</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="./News.html">News</a>
                            </li>
                            <li>
                                <a class="active" href="./Album - Google Drive.html">Album</a>
                            </li>
                            <li>
                                <a href="./Login.html">Login</a>
                            </li>
                            <li>
                                <a href="https://forum.gamer.com.tw/C.php?bsn=16583&snA=58352&tnum=747&subbsn=12" target="_blank">Join us</a>
                            </li>
                        </ul>
                    </nav>
                </td>
            </tr>
        </table>
    </center>
    <center>
        <!-- 文字介紹 -->
        <table border="0" class="styleNews" style="border-spacing: 0px 0px; padding: 0px 0px" width="1080">
            <tbody>
                <tr>
                    <td align="center" valign="top" width="960">
                        <div class="ant_bot">
                            <h1>
                                <small><font color="#f8a1a1">DAILY PHOTO</font></small>
                            </h1>
                        </div>
                        <div class="ant_top">
                            <br>
                            <p>From August 2015
                            <br>
                            <br>
                            記錄著過往的公會活動和日常</p>
                        </div>
                        
                    </td>
                </tr>
                
                <tr>
                    <td align="center" valign="top" width="960">
                        <big>LAST DAY IN GGC</big>
                    </td>
                </tr>
                <tr>
                    <td align="center" valign="top" width="960">
                        <p style="color: #f8a1a1; font-size: 12px; margin-top: 10px;">
                            如果圖片無法顯示，請通知管理員
                        </p>
                    </td>
                </tr>
                <tr>
                    <td align="left" valign="top" width="960">
                        <div class="container">
                            <div class="gallery" id="gallery">
                                <!-- 圖片將由 JavaScript 從 Google Drive 動態載入 -->
                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </center>
    <!-- The Modal -->
    <div id="myModal" class="modal">
        <span class="close">&times;</span>
        <img class="modal-content" id="img01">
        <div class="caption" id="caption"></div>
        <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
        <a class="next" onclick="plusSlides(1)">&#10095;</a>
        <div class="thumbnail"></div>
    </div>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <center>
        <p>
            <a href="./Album - Google Drive.html">Back</a>
        </p>
    </center>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <center>
    <!-- 版權聲明 -->
        <small>
            <p>&copy; 2024 SweetTears。保留所有權利。</p>
        </small>
    </center>

    <script>
        // ═══════════════════════════════════════════════════
        // Google Drive 圖片配置
        // ═══════════════════════════════════════════════════
        // 將本地圖片路徑映射到 Google Drive 檔案 ID
        // 如何取得檔案 ID：在 Google Drive 中右鍵點擊圖片 → 「取得連結」
        // 從連結中複製檔案 ID（例如：https://drive.google.com/file/d/檔案ID/view）
        // ═══════════════════════════════════════════════════
        const imageFileIdMap = {
            './Album/AUGUST 16 2019/2019_08_16_0000 (2).jpg': '1gCGViefzgeEhvxU8J2raKL1LLe1uxWON',
            './Album/AUGUST 16 2019/2019_08_16_0000.jpg': '19SYUrBAq3uTHdkuVtqMtorjOHaSbLTTC',
            './Album/AUGUST 16 2019/2019_08_16_0001 (2).jpg': '1qg2ZGEq6itKC9CwsBf3cDWqkfkI4xjMY',
            './Album/AUGUST 16 2019/2019_08_16_0001.jpg': '1GDFP2wrAwHEUaYM_qCNkWe3dfxfdmUZ5',
            './Album/AUGUST 16 2019/2019_08_16_0002 (2).jpg': '1qf_5KR9eNz4i2VnyKtD9JPiIZ11nXU-a',
            './Album/AUGUST 16 2019/2019_08_16_0002.jpg': '1CP0bdYCuGt28V9U4XQKPkMBRFFT_F2bL',
            './Album/AUGUST 16 2019/2019_08_16_0003 (2).jpg': '1BtWckVXZZCFrkTfepv9YEfpa3kLqeV5b',
            './Album/AUGUST 16 2019/2019_08_16_0003.jpg': '1CmkkZPD3P9CggKDPcRNsNCcau8894CMJ',
            './Album/AUGUST 16 2019/2019_08_16_0004 (1).jpg': '1kor5GGwHF409e1_pfAACbkNJiLW6xlQ0',
            './Album/AUGUST 16 2019/2019_08_16_0004 (2).jpg': '1biPKgn7SWwxvnyBylKzIEqbS_VruLzEC',
            './Album/AUGUST 16 2019/2019_08_16_0004.jpg': '11Adulk7ilpUf98LRmFgiFzWhqpvhwe3u',
            './Album/AUGUST 16 2019/2019_08_16_0005.jpg': '1B7Z0ntRvvxcHeYRvpG_Labqcbz8JGJwz',
            './Album/AUGUST 16 2019/2019_08_16_0006 (2).jpg': '1Nua0op-bjROzNza0Ybb-Z1AZUdTy8qGC',
            './Album/AUGUST 16 2019/2019_08_16_0006.jpg': '1wko6f15l_pLf5wNvapXld5wBlpoSnTlk',
            './Album/AUGUST 16 2019/2019_08_16_0007.jpg': '1emO-6qrVZxQLwBTA1rwOb3sbI_3-cLoE',
            './Album/AUGUST 16 2019/2019_08_16_0008 (2).jpg': '1NSgsCIDybACDBofo6LzJgc0X_bIl9IhY',
            './Album/AUGUST 16 2019/2019_08_16_0008.jpg': '1uozbqtqnD1Z-6P7STMm9jceVBlH31JyY',
            './Album/AUGUST 16 2019/2019_08_16_0009.jpg': '1GdgzHho2AfviNLAfZLIQXeh1PcCXhZ4l',
            './Album/AUGUST 16 2019/2019_08_16_0010.jpg': '1MaiA0ZL7ubXEfWLa3SpUfFInJKSn0JhS',
            './Album/AUGUST 16 2019/2019_08_16_0011.jpg': '1y58AJIDppnxhJWjguyLbX-EcAppAUW6Q',
            './Album/AUGUST 16 2019/2019_08_16_0012.jpg': '1uAhS-ggRIptGXkyhv0piZUu318F9zW_C',
            './Album/AUGUST 16 2019/2019_08_16_0013 (2).jpg': '1Ut6FPrE-M4c23S-P5PmckWVbCdW8vBmb',
            './Album/AUGUST 16 2019/2019_08_16_0013.jpg': '1AqwByTpQ82Efu_GVgHKNf-Jc9G74M7Py',
            './Album/AUGUST 16 2019/2019_08_16_0014 (1).jpg': '1WQAm2FoXWqfSPf-gkqdsJ-yIhfWOtY0l',
            './Album/AUGUST 16 2019/2019_08_16_0014 (2).jpg': '1Cy-MSkSOVV1-xQhxyspUbspeOarr6jPy',
            './Album/AUGUST 16 2019/2019_08_16_0014 (3).jpg': '1Vww_r6O4X9Qynmo_Wj4tPUF0RBBEyvH3',
            './Album/AUGUST 16 2019/2019_08_16_0014.jpg': '1ATtFHXYcIir00BdVFybA7_ItM_LH0d6M',
            './Album/AUGUST 16 2019/2019_08_16_0015.jpg': '1G9LpjvwqxhjPtai7pPISrBOyDh8YSKPp',
            './Album/AUGUST 16 2019/2019_08_16_0016.jpg': '1AK1FfXIBcDTNrBXocsfqQxpKC-_inDOe',
            './Album/AUGUST 16 2019/2019_08_16_0017-1.jpg': '175eG66ReFHlKBdBanFfCVswyJl4bTqw5',
            './Album/AUGUST 16 2019/2019_08_16_0017-2.jpg': '1Rb47QOkpnVxU0hcdIPGwXzMbfV316CRy',
            './Album/AUGUST 16 2019/2019_08_16_0017-3.jpg': '1EQ9_ob8KJQY36vgYObkSLLXJTZNDae1Y',
            './Album/AUGUST 16 2019/2019_08_16_0018.jpg': '12diUsK2mm2ALQ8CEMZEqWlRp7l-KkOvo',
            './Album/AUGUST 16 2019/2019_08_16_0019-1.jpg': '1d3dMPBPguR65Z6Jt7sePJQdYxBR0F3kh',
            './Album/AUGUST 16 2019/2019_08_16_0019-2.jpg': '1wXfTacBA0u5JWsp8XicedZm3-XtIS4AK',
            './Album/AUGUST 16 2019/2019_08_16_0020 (2).jpg': '1hRp8Jqrek86OL6-N9b5KgDZHrDiJbVX4',
            './Album/AUGUST 16 2019/2019_08_16_0020.jpg': '1UoDG3XP8KqAoq-lQUgu70qVWJLkHYfhP',
            './Album/AUGUST 16 2019/2019_08_16_0021.jpg': '1qZfSCGUJx402n5Hh-pGz2kVi0zWzj9yw',
            './Album/AUGUST 16 2019/2019_08_16_0022.jpg': '16GtVkiPjGrMkqQ8YyIabbvU1-RC4jTPG',
            './Album/AUGUST 16 2019/2019_08_16_0023.jpg': '1tCimmGWEFrM3IMajkehLy4-W_2QId7Wl',
            './Album/AUGUST 16 2019/2019_08_16_0024.jpg': '1vv3RxavfGM9d7OaG9ldnmX_ERkobnzCJ',
            './Album/AUGUST 16 2019/2019_08_16_0025.jpg': '1HvILcEK0-tJu_PZ4is5tFHa8G2eLNcM3',
            './Album/AUGUST 16 2019/2019_08_16_0026.jpg': '13pVgPqKv9FfuVH2mn2rsdqDFwIyhm4FO',
            './Album/AUGUST 16 2019/2019_08_16_0027 (2).jpg': '1MPbYYDnlkizQ1ywTHLpkqGXqMK05cl35',
            './Album/AUGUST 16 2019/2019_08_16_0027.jpg': '1xrU1bzIcfP60avrDgohDwh8GpOAejuFP',
            './Album/AUGUST 16 2019/2019_08_16_0028.jpg': '1BwawiWvujwLBSGIC_9dndP5L2KmTvELg',
            './Album/AUGUST 16 2019/2019_08_16_0029.jpg': '1NTYzFTEtBD_9xTbwC9B19CggsxVXNnSN',
            './Album/AUGUST 16 2019/2019_08_16_0030.jpg': '1asUZrQt_ZCwjzHavMbbkP1EYMA6SDVKd',
            './Album/AUGUST 16 2019/2019_08_16_0031 (2).jpg': '1pV0i8YxFp7u0HkQ2C9QHX3ouQ4iUNCcQ',
            './Album/AUGUST 16 2019/2019_08_16_0031.jpg': '1WuzJMU8MuZTq6JcbdbVg7hRlHj-ULiEb',
            './Album/AUGUST 16 2019/2019_08_16_0032.jpg': '1OmGsLB-jWHZ1dWDpBJuh38nXacuiCP9d',
            './Album/AUGUST 16 2019/2019_08_16_0033.jpg': '1hKIXsr6BMWDe5fQYiJcmDkEJt0h_cCwq',
            './Album/AUGUST 16 2019/2019_08_16_0034.jpg': '1FYdMRhks9ec6lNDMO6hm2bw9eM7TXAnE',
            './Album/AUGUST 16 2019/2019_08_16_0034_cam_1.png': '1449YWahlEktejFKgrRFG71Lhm-kEMT8t',
            './Album/AUGUST 16 2019/2019_08_16_0035.jpg': '1l1RKG1b4QrT91jHYjd49s6ssUMAsmpiZ',
            './Album/AUGUST 16 2019/2019_08_16_0035_cam_2.png': '1YhV3xJ6IA2PVgsP87h7L167F4E3o80QB',
            './Album/AUGUST 16 2019/2019_08_16_0036.jpg': '1Dq99XifqvRz_GH_Qh8Hl2RNOdAigHUJA',
            './Album/AUGUST 16 2019/2019_08_16_0037.jpg': '1jRnktuQZfpqN-8nGV2_EUt_RjIKBSjbC',
            './Album/AUGUST 16 2019/2019_08_16_0038.jpg': '1_99Vgbhfu2yrpCM6EyLVjesV1rXrhrEw',
            './Album/AUGUST 16 2019/2019_08_16_0039.jpg': '1IsL5GpE-uvgQZRzYKyA2sQMd-DjxOboI',
            './Album/AUGUST 16 2019/2019_08_16_0040.jpg': '18hcV_eLgaWCH999GFu-XqBLb9IaXLJc2',
            './Album/AUGUST 16 2019/2019_08_16_0041.jpg': '1LC3Y2MH9BJl1w-tRE-Wb6q0VoFFFRwWP',
            './Album/AUGUST 16 2019/2019_08_16_0042.jpg': '1zKS5hpAZ5Zw513Ufx85T0-XoOdpVEcS_',
            './Album/AUGUST 16 2019/2019_08_16_0043.jpg': '1tCtr14U9F42xkeg4hTkINP50z9eQYnve',
            './Album/AUGUST 16 2019/2019_08_16_0044.jpg': '1YOgeaTO6KUnseJldj8b_GZYPxdo0W_3D',
            './Album/AUGUST 16 2019/2019_08_16_0045.jpg': '1zq_TSx35oaePu3jgPyPCIhLT5lFrXF3o',
            './Album/AUGUST 16 2019/2019_08_16_0046.jpg': '1bPpTWaSNROEIROCt0vZ8cwrHWrjf8PT5',
            './Album/AUGUST 16 2019/2019_08_16_0047.jpg': '1bNz-vs-oyQRD-3KuQZFiXnnV8xXcu5ni',
            './Album/AUGUST 16 2019/2019_08_16_0048.png': '1vdcQ9tZgzUp2A5XGyGMAMDrH_CbfLkfu',
            './Album/AUGUST 16 2019/2019_08_16_0049.png': '1b6hcqQD-toJTN8KxpA-kP77e8JL19rj1',
            './Album/AUGUST 16 2019/2019_08_16_0050.png': '1AVgNChKCNYC-VDVjNIBLkyu91omub_RI',
            './Album/AUGUST 16 2019/2019_08_16_0051.png': '1xqTCzWhuy4I0i4dQM2F0Zvd5aUGVMBF2',
            './Album/AUGUST 16 2019/2019_08_16_0052.png': '1xuqxuQ2UXdrnC6k0cs4Lj93gJ6dz6mtH',
            './Album/AUGUST 16 2019/2019_08_16_0053.png': '1NAAwqvlXt5vcfkoFeU_KOd8uWqtZCjrH',
            './Album/AUGUST 16 2019/2019_08_16_0054.png': '1vYAu4koUazPEV9QMgsktji2KHCPjOx5g',
            './Album/AUGUST 16 2019/2019_08_16_0056.png': '16B0cQYxXWvB6cC-4i5zM7jRCNM7XgwL6',
            './Album/AUGUST 16 2019/unknown (1).png': '1B3VEKsZtabA-TlMWGZ6g8ypE8Us0k-jn',
            './Album/AUGUST 16 2019/unknown (2).png': '1_N8jESewTvP47_cLO5PdjddD8BzbMmWy',
            './Album/AUGUST 16 2019/unknown (3).png': '1UdL-aXDpawnVitAToKYzPA5o36CkQMn7',
            './Album/AUGUST 16 2019/unknown.png': '1239Y8-IXGdhzzrCy77A8IS49w1prPtoN',
        };
        
                // ═══════════════════════════════════════════════════
        // 可選的圖片 Alt 文字配置（用於圖片的替代文字）
        // ═══════════════════════════════════════════════════
        // 格式：原始路徑對應到 alt 文字（留空則不使用 alt）
        // 如果不需要 alt 功能，可以刪除此 map 或留空所有項目
        // ═══════════════════════════════════════════════════
        const imageAltMap = {
            // 範例：\'./Album/DAILY PHOTO/2018/2018_02_03_0004.jpg\': \'圖片描述文字\'
        };
        
        // 將檔案 ID 轉換為 Google Drive 圖片 URL
        // 嘗試多種 URL 格式以確保圖片能正常顯示
        function getGoogleDriveImageUrl(fileId) {
            if (!fileId) return '';
            // 方式1：標準的公開圖片連結（檔案需設為公開或「知道連結的使用者」）
            return `https://drive.google.com/uc?export=view&id=${fileId}`;
        }
        
        // 備用的圖片 URL 格式（如果上面的不行可以用這個）
        function getGoogleDriveImageUrlAlternative(fileId) {
            if (!fileId) return '';
            // 方式2：使用 Google 縮圖服務（需要檔案公開）
            return `https://lh3.googleusercontent.com/d/${fileId}`;
        }
        
        // ═══════════════════════════════════════════════════
        // 原有的圖片畫廊功能變數
        // ═══════════════════════════════════════════════════
        var modal = document.getElementById("myModal");
        var modalImg = document.getElementById("img01");
        var captionText = document.getElementById("caption");
        var thumbnails = document.querySelector(".thumbnail");
        var slideIndex = 0;
        var images;
        var isProgrammaticScroll = false; // 標記是否是程式控制的滾動（用於避免循環邏輯在點擊時觸發）

        // 從 Google Drive 載入圖片（只載入已經填入檔案 ID 的圖片）
        function loadImagesFromGoogleDrive() {
            const gallery = document.getElementById('gallery');
            
            // 清空畫廊
            gallery.innerHTML = '';
            
            // 遍歷 imageFileIdMap，只載入已經填入檔案 ID 的圖片
            Object.keys(imageFileIdMap).forEach(function(originalPath) {
                const fileId = imageFileIdMap[originalPath];
                // 只載入已經填入檔案 ID 的圖片（非空字串）
                if (fileId && fileId.trim() !== '') {
                    const img = document.createElement('img');
                    const imageUrl = getGoogleDriveImageUrl(fileId);
                    img.src = imageUrl;
                    img.setAttribute('data-original-path', originalPath);
                    
                    // 如果 imageAltMap 中有設定 alt，則設置 alt 屬性
                    if (imageAltMap && imageAltMap[originalPath] && imageAltMap[originalPath].trim() !== '') {
                        img.alt = imageAltMap[originalPath];
                    }
                    // 添加錯誤處理：如果圖片載入失敗，顯示提示
                    img.onerror = function() {
                        console.error('圖片載入失敗:', fileId, originalPath);
                        // 嘗試備用 URL
                        const altUrl = getGoogleDriveImageUrlAlternative(fileId);
                        if (this.src !== altUrl) {
                            this.src = altUrl;
                        } else {
                            // 如果還是失敗，顯示錯誤訊息
                            this.style.border = '2px solid red';
                            // alt removed - 錯誤訊息已移除
                        }
                    };
                    
                    // 圖片載入成功時的處理
                    img.onload = function() {
                        console.log('圖片載入成功:', fileId);
                    };
                    
                    gallery.appendChild(img);
                }
            });
            
            // 圖片載入完成後，初始化畫廊功能
            // 使用 setTimeout 確保圖片有時間載入
            setTimeout(function() {
                initGallery();
            }, 100);
        }
        
        // 初始化畫廊功能
        function initGallery() {
            images = document.querySelectorAll(".gallery img");
            
            images.forEach(function(img, index){
                img.addEventListener("click", function(){
                    modal.style.display = "block";
                    modalImg.src = this.src;
                    slideIndex = index;
                    showThumbnails();
                    showCaption();
                });
            });

            var span = document.getElementsByClassName("close")[0];

            span.onclick = function() {
                modal.style.display = "none";
            };
            
            // 啟用縮圖區域的滾輪水平滾動
            enableThumbnailWheelScroll();
        }

        function plusSlides(n) {
            showSlides(slideIndex += n);
        }

        function currentSlide(n) {
            showSlides(slideIndex = n);
        }

        function showSlides(n) {
            var slides = document.querySelectorAll('.gallery img');
            if (n >= slides.length) {slideIndex = 0;}
            if (n < 0) {slideIndex = slides.length - 1;}
            modalImg.src = slides[slideIndex].src;
            showThumbnails();
            showCaption();
        }

        function showThumbnails() {
            thumbnails.innerHTML = "";
            
            // 為了實現循環滾動，在開頭複製最後一張，在結尾複製第一張
            var totalImages = images.length;
            
            // 創建最後一張的縮圖（放在最前面，作為循環連接）
            if (totalImages > 0) {
                var lastThumb = document.createElement("img");
                lastThumb.src = images[totalImages - 1].src;
                lastThumb.alt = "thumbnail " + totalImages;
                lastThumb.classList.add("clone-last");
                lastThumb.onclick = function() {
                    currentSlide(totalImages - 1);
                };
                thumbnails.appendChild(lastThumb);
            }
            
            // 創建真實的縮圖
            images.forEach(function(img, index){
                var thumb = document.createElement("img");
                thumb.src = img.src;
                thumb.alt = "thumbnail " + (index + 1);
                thumb.setAttribute("data-index", index);
                if (index === slideIndex) {
                    thumb.classList.add("active");
                }
                thumb.onclick = function() {
                    currentSlide(index);
                };
                thumbnails.appendChild(thumb);
            });
            
            // 創建第一張的縮圖（放在最後面，作為循環連接）
            if (totalImages > 0) {
                var firstThumb = document.createElement("img");
                firstThumb.src = images[0].src;
                // firstThumb.alt removed
                firstThumb.classList.add("clone-first");
                firstThumb.onclick = function() {
                    currentSlide(0);
                };
                thumbnails.appendChild(firstThumb);
            }
            
            // 確保當前選中的縮圖可見（滾動到可見區域）
            // 需要滾動到真實圖片位置，不是複製的圖片
            var activeThumb = thumbnails.querySelector('img.active');
            if (activeThumb) {
                // 標記這是程式控制的滾動，避免觸發循環邏輯
                isProgrammaticScroll = true;
                
                // 計算真實縮圖的位置（需要考慮開頭的複製圖片）
                setTimeout(function() {
                    // 確保滾動到真實圖片區域，而不是複製的圖片
                    // 使用 center 確保圖片居中，避免太靠近邊緣觸發循環邏輯
                    activeThumb.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                    
                    // 等待滾動完成後，再等待一段時間才取消標記，確保不會觸發循環邏輯
                    // 增加延遲時間，確保滾動動畫完全結束
                    setTimeout(function() {
                        isProgrammaticScroll = false;
                    }, 1000);
                }, 200);
            } else {
                // 如果沒有找到 active 縮圖，也需要重置標記
                setTimeout(function() {
                    isProgrammaticScroll = false;
                }, 1000);
            }
        }
        
        // 啟用縮圖區域的滾輪水平滾動（包含循環效果）
        function enableThumbnailWheelScroll() {
            thumbnails.addEventListener('wheel', function(e) {
                // 防止預設的垂直滾動
                if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {
                    e.preventDefault();
                    // 將垂直滾動轉換為水平滾動
                    this.scrollLeft += e.deltaY;
                }
            }, { passive: false });
            
            // 監聽滾動事件，實現真正的循環效果（無縫循環）
            thumbnails.addEventListener('scroll', function() {
                // 如果是程式控制的滾動，不觸發循環邏輯
                if (isProgrammaticScroll) return;
                
                var scrollLeft = this.scrollLeft;
                var clientWidth = this.clientWidth;
                
                // 計算第一張和最後一張真實圖片的位置
                var firstRealThumb = this.querySelector('img[data-index="0"]');
                var lastRealThumb = this.querySelector('img[data-index="' + (images.length - 1) + '"]');
                
                if (!firstRealThumb || !lastRealThumb) return;
                
                var firstRealLeft = firstRealThumb.offsetLeft;
                var lastRealLeft = lastRealThumb.offsetLeft;
                var lastRealRight = lastRealLeft + lastRealThumb.offsetWidth;
                
                // 獲取複製圖片的位置
                var cloneLastThumb = this.querySelector('img.clone-last');
                var cloneFirstThumb = this.querySelector('img.clone-first');
                
                if (cloneLastThumb && cloneFirstThumb) {
                    var cloneLastRight = cloneLastThumb.offsetLeft + cloneLastThumb.offsetWidth;
                    var cloneFirstLeft = cloneFirstThumb.offsetLeft;
                    var viewportRight = scrollLeft + clientWidth;
                    
                    // 如果滾動到最右邊（看到結尾的複製圖片），立即無縫調整到開頭
                    if (scrollLeft >= cloneFirstLeft) {
                        isProgrammaticScroll = true;
                        // 直接調整 scrollLeft，讓它看起來是連續的
                        // 計算：從複製的第一張圖片區域調整到對應的真實第一張圖片位置
                        // 偏移量 = 真實第一張位置 - 複製第一張位置
                        var offset = firstRealLeft - cloneFirstLeft;
                        // 調整後的位置 = 當前滾動位置 - 偏移量
                        this.scrollLeft = scrollLeft - offset;
                        // 立即取消標記，因為這是一次性的調整
                        setTimeout(function() {
                            isProgrammaticScroll = false;
                        }, 50);
                    }
                    // 如果滾動到最左邊（看到開頭的複製圖片），立即無縫調整到結尾
                    else if (scrollLeft < cloneLastRight) {
                        isProgrammaticScroll = true;
                        // 直接調整 scrollLeft，讓它看起來是連續的
                        // 計算：從複製的最後一張圖片區域調整到對應的真實最後一張圖片位置
                        // 偏移量 = 真實最後一張位置 - 複製最後一張右邊界
                        var offset = lastRealLeft - cloneLastRight;
                        // 調整後的位置 = 當前滾動位置 - 偏移量
                        this.scrollLeft = scrollLeft - offset;
                        // 立即取消標記，因為這是一次性的調整
                        setTimeout(function() {
                            isProgrammaticScroll = false;
                        }, 50);
                    }
                }
            });
        }

        function showCaption() {
            captionText.innerHTML = images[slideIndex].alt || ''; // 如果有 alt 則顯示，否則顯示空字串，路徑資訊保留在 data-original-path 屬性中
        }
        
        // 頁面載入時執行從 Google Drive 載入圖片
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadImagesFromGoogleDrive);
        } else {
            loadImagesFromGoogleDrive();
        }
    </script>

    </div>

    </body>

</html>

